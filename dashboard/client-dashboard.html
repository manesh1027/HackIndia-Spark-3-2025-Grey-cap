<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .sidebar {
            background: #f8f9fa;
            min-height: 100vh;
            padding: 20px;
        }
        .stat-card {
            border: none;
            border-radius: 15px;
            transition: transform 0.2s;
        }
        .stat-card:hover {
            transform: translateY(-5px);
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 300px;
            margin-bottom: 20px;
        }
        .activity-item {
            padding: 10px;
            border-left: 3px solid #007bff;
            margin-bottom: 10px;
            background: #f8f9fa;
        }
        .logout-btn {
            margin-top: auto;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-2 sidebar">
                <h3 class="mb-4 text-primary">MINDLancer</h3>
                <div class="d-flex flex-column h-100">
                    <a href="#" class="btn btn-outline-primary mb-2 text-start active" id="dashboard-tab">
                        <i class="fas fa-chart-line me-2"></i>Dashboard
                    </a>
                    <a href="#" class="btn btn-outline-primary mb-2 text-start" id="company-profile-tab">
                        <i class="fas fa-building me-2"></i>Company Profile
                    </a>
                    <a href="#" class="btn btn-outline-primary mb-2 text-start" id="post-job-tab">
                        <i class="fas fa-plus-circle me-2"></i>Post a Job
                    </a>
                    <a href="#" class="btn btn-outline-primary mb-2 text-start" id="my-posts-tab">
                        <i class="fas fa-list me-2"></i>My Job Posts
                    </a>
                    <a href="#" class="btn btn-outline-primary mb-2 text-start" id="search-freelancers-tab">
                        <i class="fas fa-search me-2"></i>Search Freelancers
                    </a>
                    <a href="/logout" class="btn btn-danger mb-2 text-start mt-auto logout-btn">
                        <i class="fas fa-sign-out-alt me-2"></i>Logout
                    </a>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-10 p-4">
                <!-- Dashboard Overview -->
                <div id="dashboard-content" class="content-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2>Dashboard Overview</h2>
                        <div class="btn-group">
                            <button class="btn btn-outline-primary">Week</button>
                            <button class="btn btn-outline-primary active">Month</button>
                            <button class="btn btn-outline-primary">Year</button>
                        </div>
                    </div>

                    <!-- Stats Row -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card stat-card bg-primary text-white">
                                <div class="card-body">
                                    <h6 class="card-title">Active Jobs</h6>
                                    <h2 class="mb-0">5</h2>
                                    <small class="text-white-50">↑ 12% from last month</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card stat-card bg-success text-white">
                                <div class="card-body">
                                    <h6 class="card-title">Completed Jobs</h6>
                                    <h2 class="mb-0">12</h2>
                                    <small class="text-white-50">↑ 8% from last month</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card stat-card bg-info text-white">
                                <div class="card-body">
                                    <h6 class="card-title">Total Spent</h6>
                                    <h2 class="mb-0">$2.5k</h2>
                                    <small class="text-white-50">↑ 15% from last month</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card stat-card bg-warning text-white">
                                <div class="card-body">
                                    <h6 class="card-title">Active Proposals</h6>
                                    <h2 class="mb-0">8</h2>
                                    <small class="text-white-50">↓ 3% from last month</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row -->
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Job Activity Overview</h5>
                                    <div class="chart-container">
                                        <canvas id="jobActivityChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Budget Distribution</h5>
                                    <div class="chart-container">
                                        <canvas id="budgetPieChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title mb-4">Recent Activity</h5>
                            <div class="activity-item">
                                <div class="d-flex justify-content-between">
                                    <strong>New proposal received</strong>
                                    <small>2 hours ago</small>
                                </div>
                                <p class="mb-0">John Doe submitted a proposal for "Website Development"</p>
                            </div>
                            <div class="activity-item">
                                <div class="d-flex justify-content-between">
                                    <strong>Job completed</strong>
                                    <small>1 day ago</small>
                                </div>
                                <p class="mb-0">Mobile App UI Design project was marked as completed</p>
                            </div>
                            <div class="activity-item">
                                <div class="d-flex justify-content-between">
                                    <strong>New job posted</strong>
                                    <small>2 days ago</small>
                                </div>
                                <p class="mb-0">You posted a new job "Frontend Developer Required"</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Company Profile Section -->
                <div id="company-profile-content" class="content-section d-none">
                    <div class="d-flex justify-content-between align-items-center">
                        <h2>Company Profile</h2>
                        <div class="verification-status">
                            <span class="badge bg-warning" id="unverified-badge">Unverified</span>
                            <span class="badge bg-success d-none" id="verified-badge">Verified</span>
                        </div>
                    </div>
                    
                    <form id="company-profile-form" class="mt-4">
                        <div class="mb-3">
                            <label class="form-label">Company Name*</label>
                            <input type="text" class="form-control" name="companyName" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Industry*</label>
                            <select class="form-control" name="industry" required>
                                <option value="">Select Industry</option>
                                <option value="technology">Technology</option>
                                <option value="healthcare">Healthcare</option>
                                <option value="finance">Finance</option>
                                <option value="education">Education</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Company Description*</label>
                            <textarea class="form-control" name="description" rows="4" required></textarea>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Website</label>
                            <input type="url" class="form-control" name="website" placeholder="https://">
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Hiring Needs</label>
                            <textarea class="form-control" name="hiringNeeds" rows="3" 
                                placeholder="Describe your current hiring needs and requirements"></textarea>
                        </div>

                        <div class="card mb-3">
                            <div class="card-body">
                                <h5 class="card-title">Business Verification</h5>
                                <p class="card-text">To get verified status, please provide the following documents:</p>
                                <div class="mb-3">
                                    <label class="form-label">Business Registration Document</label>
                                    <input type="file" class="form-control" accept=".pdf,.doc,.docx">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Tax ID Number</label>
                                    <input type="text" class="form-control">
                                </div>
                                <button type="button" class="btn btn-primary" id="submit-verification">
                                    Submit for Verification
                                </button>
                            </div>
                        </div>

                        <div class="d-flex justify-content-between">
                            <button type="submit" class="btn btn-primary">Save Profile</button>
                            <button type="button" class="btn btn-outline-secondary">Cancel</button>
                        </div>
                    </form>
                </div>

                <!-- Post Job Form -->
                <div id="post-job-content" class="content-section d-none">
                    <h2>Post a New Job</h2>
                    <form id="job-form" class="mt-4">
                        <div class="mb-3">
                            <label class="form-label">Job Title</label>
                            <input type="text" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" rows="4" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Budget Range</label>
                            <div class="row">
                                <div class="col">
                                    <input type="number" class="form-control" placeholder="Min" required>
                                </div>
                                <div class="col">
                                    <input type="number" class="form-control" placeholder="Max" required>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Post Job</button>
                    </form>
                </div>

                <!-- My Job Posts -->
                <div id="my-posts-content" class="content-section d-none">
                    <h2>My Job Posts</h2>
                    <div class="job-listings mt-4">
                        <div id="no-jobs-message" class="alert alert-info">
                            You haven't posted any jobs yet. Use the "Post a Job" section to create your first job posting.
                        </div>
                    </div>
                </div>

                <!-- Search Freelancers -->
                <div id="search-freelancers-content" class="content-section d-none">
                    <h2>Search Freelancers</h2>
                    <div class="row mt-4">
                        <div class="col-md-12 mb-3">
                            <input type="text" class="form-control" placeholder="Search by skills, name, or expertise">
                        </div>
                    </div>
                    <div class="freelancer-listings">
                        <!-- Sample Freelancer Card -->
                        <div class="card mb-3">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-2">
                                        <img src="https://via.placeholder.com/80" class="rounded-circle" alt="Profile">
                                    </div>
                                    <div class="col-md-10">
                                        <h5>John Doe</h5>
                                        <p class="text-muted">Web Developer | UI Designer</p>
                                        <p>5 years experience in web development and design...</p>
                                        <button class="btn btn-primary btn-sm">View Profile</button>
                                        <button class="btn btn-outline-primary btn-sm">Contact</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Chart Configurations
        const jobActivityChart = new Chart(document.getElementById('jobActivityChart'), {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                    label: 'Posted Jobs',
                    data: [3, 5, 4, 6, 8, 5],
                    borderColor: '#007bff',
                    tension: 0.4
                }, {
                    label: 'Completed Jobs',
                    data: [2, 3, 3, 4, 6, 4],
                    borderColor: '#28a745',
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });

        const budgetPieChart = new Chart(document.getElementById('budgetPieChart'), {
            type: 'doughnut',
            data: {
                labels: ['Web Development', 'Design', 'Marketing', 'Content'],
                datasets: [{
                    data: [40, 25, 20, 15],
                    backgroundColor: ['#007bff', '#28a745', '#ffc107', '#17a2b8']
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });

        // Initialize jobs array in localStorage if it doesn't exist
        if (!localStorage.getItem('jobs')) {
            localStorage.setItem('jobs', JSON.stringify([]));
        }

        // Function to save job
        function saveJob(job) {
            const jobs = JSON.parse(localStorage.getItem('jobs')) || [];
            jobs.push({
                id: Date.now(),
                ...job,
                postDate: new Date().toISOString()
            });
            localStorage.setItem('jobs', JSON.stringify(jobs));
        }

        // Function to display jobs
        function displayJobs() {
            const jobListings = document.querySelector('.job-listings');
            const noJobsMessage = document.getElementById('no-jobs-message');
            const jobs = JSON.parse(localStorage.getItem('jobs')) || [];
            
            if (jobs.length === 0) {
                jobListings.innerHTML = `
                    <div id="no-jobs-message" class="alert alert-info">
                        You haven't posted any jobs yet. Use the "Post a Job" section to create your first job posting.
                    </div>
                `;
                return;
            }
            
            jobListings.innerHTML = jobs.map(job => `
                <div class="card mb-3" data-job-id="${job.id}">
                    <div class="card-body">
                        <div class="d-flex justify-content-between">
                            <h5 class="card-title">${job.title}</h5>
                            <div>
                                <button class="btn btn-sm btn-primary edit-job">Edit</button>
                                <button class="btn btn-sm btn-danger delete-job">Delete</button>
                            </div>
                        </div>
                        <p class="card-text">${job.description}</p>
                        <div class="text-muted">Budget: $${job.budgetMin}-${job.budgetMax} | Posted: ${timeAgo(new Date(job.postDate))}</div>
                    </div>
                </div>
            `).join('');

            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.delete-job').forEach(button => {
                button.addEventListener('click', function() {
                    const jobId = this.closest('.card').dataset.jobId;
                    deleteJob(jobId);
                });
            });
        }

        // Function to delete job
        function deleteJob(jobId) {
            if (confirm('Are you sure you want to delete this job?')) {
                const jobs = JSON.parse(localStorage.getItem('jobs')) || [];
                const updatedJobs = jobs.filter(job => job.id !== parseInt(jobId));
                localStorage.setItem('jobs', JSON.stringify(updatedJobs));
                displayJobs();
            }
        }

        // Time ago function
        function timeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            const intervals = {
                year: 31536000,
                month: 2592000,
                day: 86400,
                hour: 3600,
                minute: 60
            };
            
            for (const [unit, secondsInUnit] of Object.entries(intervals)) {
                const interval = Math.floor(seconds / secondsInUnit);
                if (interval >= 1) {
                    return `${interval} ${unit}${interval === 1 ? '' : 's'} ago`;
                }
            }
            return 'just now';
        }

        // Job form submission
        document.getElementById('job-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = {
                title: this.querySelector('input[type="text"]').value,
                description: this.querySelector('textarea').value,
                budgetMin: this.querySelector('input[placeholder="Min"]').value,
                budgetMax: this.querySelector('input[placeholder="Max"]').value
            };
            
            saveJob(formData);
            this.reset();
            alert('Job posted successfully!');
        });

        // Tab switching logic with job listing refresh
        document.querySelectorAll('[id$="-tab"]').forEach(tab => {
            tab.addEventListener('click', (e) => {
                e.preventDefault();
                document.querySelectorAll('[id$="-tab"]').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                document.querySelectorAll('.content-section').forEach(section => section.classList.add('d-none'));
                const contentId = tab.id.replace('-tab', '-content');
                document.getElementById(contentId).classList.remove('d-none');
                
                // Refresh job listings when switching to my-posts tab
                if (contentId === 'my-posts-content') {
                    displayJobs();
                }
            });
        });

        // Add to existing script section
        document.getElementById('submit-verification').addEventListener('click', function() {
            alert('Verification documents submitted. We will review and get back to you within 2-3 business days.');
        });

        document.getElementById('company-profile-form').addEventListener('submit', function(e) {
            e.preventDefault();
            // Add your save logic here
            alert('Company profile saved successfully!');
        });
    </script>
</body>
</html>